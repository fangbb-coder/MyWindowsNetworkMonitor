# 我的Windows网络实时连接监控系统用户指南

## 简介
这是一个网络流量监控系统，可以捕获和分析网络数据包，提供Web界面进行实时监控。

## 系统要求
- Windows操作系统
- Python 3.7+
- 管理员权限（用于网络监控）
- GeoLite2数据库文件（用于IP地理位置查询，需单独下载）

## 快速开始

### 方法1：使用启动脚本（推荐）
1. 右键点击 `Start Monitor.bat`
2. 选择"以管理员身份运行"
3. 在UAC提示中点击"是"
4. 浏览器将自动打开 http://localhost:8080
5. 点击"开始监控"按钮

### 方法2：手动启动
1. 打开命令提示符（以管理员身份）
2. 导航到项目目录
3. 执行命令：
   ```
   python start_web_interface.py
   ```
4. 在浏览器中访问 http://localhost:8080

## 功能特性

### 仪表盘
- 显示网络流量统计数据
- 实时数据更新
- 协议分布图表

### 连接监控
- 显示活动网络连接
- 按IP地址和端口分类
- 连接状态监控

### 进程监控
- 显示产生网络流量的进程
- 按流量大小排序
- 进程网络使用统计

### 协议分析
- 显示按协议分类的流量分布
- 支持TCP、UDP、ICMP等协议
- 实时协议统计

## 配置说明

配置文件位于 `config.json`，您可以修改以下设置：
- `interface`: 网络接口（默认："auto"）
- `web_port`: Web界面端口（默认：8080）
- `refresh_interval`: 刷新间隔（毫秒）
- `blacklist_ip/ip/port`: 黑名单设置

## 故障排除

### 问题：无法启动监控
1. 确保以管理员身份运行
2. 检查防火墙设置
3. 确保Python环境正确安装

### 问题：无法访问Web界面
1. 检查端口8080是否被占用
2. 确保应用程序已启动
3. 尝试使用不同的浏览器

### 问题：无法捕获数据包
1. 确保存在网络活动
2. 检查网络接口是否正确
3. 检查Windows防火墙设置

## 权限说明

本应用基于Windows原生API实现网络监控功能，无需安装Npcap或WinPcap驱动。
但需要管理员权限才能获取完整的网络统计信息。

## GeoLite2数据库说明

本应用使用MaxMind的GeoLite2数据库进行IP地理位置查询。由于许可限制，您需要自行下载此数据库文件：

1. 访问 MaxMind官网注册账户：https://www.maxmind.com/
2. 下载GeoLite2 City数据库
3. 将数据库文件放置在项目根目录下，确保文件名为`GeoLite2-City.mmdb`

注意：IP地理位置查询为可选功能，即使没有数据库文件，应用的核心监控功能仍可正常使用。

## 许可证

本项目仅供学习和研究用途。